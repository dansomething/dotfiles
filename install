#!/usr/bin/env bash

DOTFILES="dansomething/dotfiles"
DOTVIM="https://github.com/dansomething/dot_vim.git"
VUNDLE="http://github.com/gmarik/vundle.git"

# Check for required commands...
# TODO Remove the dependency on gem
CMDS="gem git vim"
for cmd in $CMDS; do
    type -P $cmd &>/dev/null && continue || { echo "$cmd command not found. Please install $cmd."; exit 1; }
done

# Install required gems...
# TODO Remove the dependency on rake
GEMS="rake"
for gem in $GEMS; do
    found=`gem list $gem | grep -i $gem`
    if [ "$found" != "" ]; then
        parts=( $found )
        echo "Found ${parts[0]} ${parts[1]}"
        continue
    fi

    echo "---------------------------"
    echo "Installing $gem"
    sudo gem install $gem
    echo "---------------------------"
done

curl -sL https://raw.github.com/andsens/homeshick/master/install.sh | bash

# Install dotfiles
~/.homeshick clone $DOTFILES
~/.homeshick symlink dotfiles

# Install dot_vim + vundle
# .vim should be pulled as a submodule of the dotfiles
cd ~/.vim
git clone $VUNDLE bundle/vundle
rake vim:link
vim +BundleInstall +qall
