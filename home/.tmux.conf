# C-a should be the Tmux default prefix, really
set -g prefix C-a
unbind C-b
set -g mode-keys vi

# enable mouse features for terminals that support it
if-shell "[[ `tmux -V | cut -d ' ' -f2 | sed 's/[a\.]//g'` -ge 21 ]]" \
  'set -g mouse on;'
if-shell "[[ `tmux -V | cut -d ' ' -f2 | sed 's/[a\.]//g'` -lt 21 ]]" \
  'set -g mode-mouse on; \
   set -g mouse-utf8 on; \
   set -g mouse-resize-pane on; \
   set -g mouse-select-pane on; \
   set -g mouse-select-window on'

# auto renumber windows as they are changed
set -g renumber-windows on

# Setup Environment (ensure ssh agent works across sessions and reconnections)
set -g update-environment "DISPLAY SSH_ASKPASS SSH_AGENT_PID SSH_CONNECTION WINDOWID XAUTHORITY"
set-environment -g SSH_AUTH_SOCK $HOME/.ssh/ssh-auth-sock.$HOSTNAME

# Open new splits in the current path
bind "\"" split-window -c '#{pane_current_path}'
bind "\%" split-window -h -c '#{pane_current_path}'

# Setup 'v' to begin selection as in Vim
bind-key -t vi-copy v begin-selection

# Dismiss current pane to background window
bind b break-pane -d
bind-key C-i command-prompt -p "join pane from: "  "join-pane -h -s '%%'"

# prefix + G searches for git commit SHA1.
set -g @copycat_search_G '\b[0-9a-f]{5,40}\b'

# status bar
source-file ~/.tmuxline.conf

# List of installed plugins by Tmux Plugin Manager (TPM)
# Supports `github_username/repo` or full git repo URLs
# Make sure to clone TPM before using `prefix + I` to install plugins
# git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
set -g @tpm_plugins '              \
  tmux-plugins/tpm                 \
  tmux-plugins/tmux-copycat        \
  tmux-plugins/tmux-logging        \
  tmux-plugins/tmux-open           \
  tmux-plugins/tmux-pain-control   \
  tmux-plugins/tmux-resurrect      \
  tmux-plugins/tmux-sensible       \
  tmux-plugins/tmux-yank           \
  clauswitt/tmux_split_nav         \
  nhdaly/tmux-scroll-copy-mode     \
'

# Plugin configuration
set -g @resurrect-strategy-vim 'session'
set -g @resurrect-strategy-nvim 'session'
set -g @resurrect-processes '"grunt->grunt serve"'

# Initializes TMUX plugin manager.
# Keep this line at the very bottom of tmux.conf.
run-shell '~/.tmux/plugins/tpm/tpm'
